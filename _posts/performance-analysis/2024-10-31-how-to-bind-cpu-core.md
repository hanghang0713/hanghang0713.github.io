---
layout: post
title:  "指定 CPU 运行核心"
tags: C++ analysis
category: Qt 
---

# 通过绑定 CPU 核心，提高程序的运行稳定性

## 问题
最开始在一台 PC 上面发现程序异常卡顿。功能完全无法正常使用。后续使用同型号的 PC 验证，程序存在同样的现象。
因此排除单台 PC 硬件异常的情况，问题在部分模块上面是共性问题（12th Gen Intel(R) Core(TM) i7-12700   2.10 GHz）。
：使用 ffmpeg 采集摄像头画面时，出现频繁的丢帧现象，导致后续功能无法实现。

## 分析过程

### 第一次分析

**原理：** 当处理的速度匹配不上摄像头画面数据输入的速度时，ffmpeg 就会丢弃缓冲区中的帧。

**怀疑：** 最开始第一反应是认为后续在处理 ffmpeg 采集到的数据时，处理过程有问题导致的丢帧。但是使用其他 PC 模块程序可以正常运行，只在该型号机器上无法运行。因此怀疑是 CPU 性能问题。
为了证明这个观点：进行了如下的操作和对比
- 屏蔽了后续的处理流程，只保留采集和解码的过程， 丢帧现象依然存在。
- 屏蔽了后续的处理流程，降低采集的分辨率，不会丢帧。

因此当时认为就是 CPU 的性能问题，该型号的 CPU 不足以支撑整个这个功能。

**疑点：** 但是上面的结论比较反直觉：代系更低的 CPU 可以正常运行，代系更高的反而不行，不太符合常理。

### 重新分析



